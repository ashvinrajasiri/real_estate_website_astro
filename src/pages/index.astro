---
import Layout from '~/layouts/PageLayout.astro';
import Hero from '~/components/widgets/Hero.astro';
import Features from '~/components/widgets/Features.astro';
import Content from '~/components/widgets/Content.astro';
import CallToAction from '~/components/widgets/CallToAction.astro';
import Testimonials from '~/components/widgets/Testimonials.astro';
import Stats from '~/components/widgets/Stats.astro';
import PropertyCard from '~/components/common/PropertyCard.astro';
import { getAllProperties } from '~/utils/sanity';
import { getTestimonials } from '~/utils/googleReviews';

const metadata = {
  title: 'Find Your Dream Home - Professional Real Estate Services',
  ignoreTitleTemplate: true,
};

// Get all properties from Sanity
const properties = await getAllProperties();

// Get testimonials from Google Reviews
const testimonials = await getTestimonials();

// Get featured properties (first 6)
const featuredProperties = properties.slice(0, 6);
---

<Layout metadata={metadata}>
  <!-- Hero Section -->
  <Hero
    isReversed={true}
    actions={[
      {
        variant: 'primary',
        text: 'View Properties',
        href: '/properties',
        icon: 'tabler:home-search',
      },
      { text: 'Contact Me', href: '/contact' },
    ]}
    image={{
      src: 'https://images.unsplash.com/photo-1560518883-ce09059eeffa?ixlib=rb-4.0.3&auto=format&fit=crop&w=1920&q=80',
      alt: 'Beautiful home exterior'
    }}
  >
    <Fragment slot="title">
      Find Your <span class="text-accent dark:text-white">Dream Home</span> in the Greater Toronto Area
    </Fragment>

    <Fragment slot="subtitle">
      Finding the perfect home for your family. Expert guidance with a personal touch every step of the way.
    </Fragment>
  </Hero>

  <!-- Featured Properties Section -->
  <section class="px-4 py-16 sm:px-6 mx-auto lg:px-8 lg:py-20 max-w-7xl" id="featured">
    <div class="mb-10 md:mb-12 text-center">
      <p class="text-base text-accent dark:text-blue-200 font-semibold tracking-wide uppercase">
        Featured Listings
      </p>
      <h2 class="text-4xl md:text-5xl font-bold leading-tighter tracking-tighter mb-4 font-heading">
        Explore Our Latest Properties
      </h2>
      <p class="max-w-3xl mx-auto text-xl text-muted dark:text-slate-400">
        Handpicked properties that offer exceptional value and quality in prime locations
      </p>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8">
      {featuredProperties.map((property) => (
        <PropertyCard property={property} />
      ))}
    </div>

    <div class="text-center mt-10">
      <a
        href="/properties"
        class="btn btn-primary inline-flex items-center justify-center px-6 py-3 text-white bg-blue-600 hover:bg-blue-700 rounded-lg font-semibold transition-colors"
      >
        View All Properties
        <svg class="w-5 h-5 ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3" />
        </svg>
      </a>
    </div>
  </section>

  <!-- Services Section -->
  <Features
    id="services"
    tagline="Services"
    title="How I Can Help You"
    subtitle="Comprehensive real estate services tailored to your unique needs"
    items={[
      {
        title: 'Buyer Representation',
        description:
          'Expert guidance through the home buying process, from property search to closing. I help you find the perfect home within your budget.',
        icon: 'tabler:home-search',
      },
      {
        title: 'Seller Services',
        description:
          'Professional marketing, staging advice, and negotiation to get you the best price for your property in the shortest time.',
        icon: 'tabler:building',
      },
      {
        title: 'Market Analysis',
        description:
          'Detailed comparative market analysis to help you make informed decisions about pricing and market timing.',
        icon: 'tabler:chart-line',
      },
      {
        title: 'Property Management',
        description:
          'Full-service rental property management including tenant screening, maintenance, and rent collection.',
        icon: 'tabler:key',
      },
      {
        title: 'Investment Consulting',
        description:
          'Strategic advice for real estate investors looking to build wealth through property investments.',
        icon: 'tabler:cash',
      },
      {
        title: 'First-Time Buyers',
        description:
          'Specialized support for first-time homebuyers, including education about the process and financing options.',
        icon: 'tabler:users',
      },
    ]}
  />

  <!-- Why Choose Me Section -->
  <Content
    isReversed
    tagline="Why Choose Me"
    title="Your Trusted Real Estate Partner"
    items={[
      {
        title: 'Local Market Expertise',
        description:
          'Deep knowledge of local neighborhoods, schools, amenities, and market trends to help you make the best decision.',
      },
      {
        title: 'Proven Track Record',
        description:
          'Years of successful transactions and satisfied clients who trust me for their real estate needs.',
      },
      {
        title: 'Personalized Service',
        description:
          'Every client is unique. I take the time to understand your specific needs and goals.',
      },
    ]}
    image={{
      src: 'https://images.unsplash.com/photo-1600585154340-be6161a56a0c?ixlib=rb-4.0.3&auto=format&fit=crop&w=2070&q=80',
      alt: 'Real estate professional',
    }}
  >
    <Fragment slot="content">
      <h3 class="text-2xl font-bold tracking-tight dark:text-white sm:text-3xl mb-2">
        Experience That Makes a Difference
      </h3>
      Dedicated to providing exceptional service and results that exceed expectations
    </Fragment>

    <Fragment slot="bg">
      <div class="absolute inset-0 bg-blue-50 dark:bg-transparent"></div>
    </Fragment>
  </Content>

  <!-- Stats Section -->
  <Stats
    stats={[
      { title: 'Properties Sold', amount: '200+' },
      { title: 'Happy Clients', amount: '150+' },
      { title: 'Years Experience', amount: '10+' },
      { title: 'Average Rating', amount: '4.9/5' },
    ]}
  />

  <!-- Testimonials Section -->
  <Testimonials
    title="What My Clients Say"
    subtitle="Real feedback from satisfied homebuyers and sellers"
    tagline="Testimonials"
    testimonials={testimonials}
  />

  <!-- Call to Action -->
  <CallToAction
    actions={[
      {
        variant: 'primary',
        text: 'Schedule Consultation',
        href: '/contact',
        icon: 'tabler:calendar',
      },
      {
        variant: 'secondary',
        text: 'Browse Properties',
        href: '/properties',
      },
    ]}
  >
    <Fragment slot="title">
      Ready to Make Your Move?
    </Fragment>

    <Fragment slot="subtitle">
      Let's discuss your real estate goals and find the perfect property for you.
      <br class="hidden md:inline" />
      Schedule a free, no-obligation consultation today.
    </Fragment>
  </CallToAction>
</Layout>
